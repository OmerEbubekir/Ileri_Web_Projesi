<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - EduTech</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>
<body class="bg-gray-50 flex flex-col min-h-screen font-sans">

    <nav class="bg-slate-900 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">

                <a href="/" class="text-2xl font-bold flex items-center gap-2 tracking-wide hover:text-indigo-400 transition">
                    <i class="fa-solid fa-graduation-cap text-indigo-500"></i> EduTech
                </a>

                <div class="hidden md:flex items-center space-x-6">
                    <a href="/Home/Index" class="hover:text-indigo-300 transition text-sm font-medium uppercase tracking-wider">Anasayfa</a>
                    <a href="/Course/Index" class="hover:text-indigo-300 transition text-sm font-medium uppercase tracking-wider">Kurslar</a>
                    <a href="/Home/About" class="hover:text-indigo-300 transition text-sm font-medium uppercase tracking-wider">Hakkımızda</a>

                    @if (Context.Session.GetString("Role") == "Admin")
                    {
                        <a href="/Category/Index" class="bg-gray-700 px-3 py-1 rounded text-xs font-bold hover:bg-gray-600 transition border border-gray-600 flex items-center gap-1">
                            <i class="fa-solid fa-gear"></i> Yönetim
                        </a>
                    }
                </div>

                <div class="flex items-center gap-4">

                    <form action="/Course/Search" method="get" class="hidden lg:flex items-center bg-slate-700 rounded-full px-3 py-1.5 border border-slate-600 focus-within:border-indigo-500 transition">
                        <input type="text" name="q" placeholder="Kurs ara..." class="bg-transparent border-none text-white placeholder-gray-400 focus:outline-none text-sm px-2 w-48" />
                        <button type="submit" class="text-gray-300 hover:text-white p-1">
                            <i class="fa-solid fa-search"></i>
                        </button>
                    </form>

                    @{
                        var userRole = Context.Session.GetString("Role");
                        var userName = Context.Session.GetString("Fullname");
                    }

                    @if (string.IsNullOrEmpty(userName))
                    {
                        <div class="flex items-center gap-3">
                            <a href="/Auth/Login" class="text-gray-300 hover:text-white font-semibold text-sm transition">Giriş</a>
                            <a href="/Auth/Register" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold text-sm transition shadow-lg hover:shadow-indigo-500/30">
                                Kayıt Ol
                            </a>
                        </div>
                    }
                    else
                    {
                        <div class="flex items-center gap-4 border-l border-slate-700 pl-4 ml-2">

                            @if (userRole == "Student")
                            {
                                <a href="/Student/MyCourses" class="flex items-center gap-2 text-indigo-300 hover:text-white font-semibold transition bg-slate-800 hover:bg-slate-700 px-3 py-1.5 rounded-md border border-slate-700">
                                    <i class="fa-solid fa-book-open"></i> <span class="hidden sm:inline text-sm">Kurslarım</span>
                                </a>
                            }

                            <div class="hidden md:flex flex-col items-end leading-tight text-right">
                                <span class="font-bold text-sm text-gray-100">@userName</span>
                                <span class="text-[10px] uppercase tracking-wider text-indigo-400 font-bold">@userRole</span>
                            </div>

                            <a href="/Auth/Logout" class="text-red-400 hover:text-red-300 bg-red-400/10 p-2 rounded-full transition hover:bg-red-400/20" title="Çıkış Yap">
                                <i class="fa-solid fa-right-from-bracket"></i>
                            </a>
                        </div>
                    }
                </div>
            </div>
        </div>
    </nav>

    <main class="flex-grow container mx-auto px-4 py-8">
        @RenderBody()
    </main>

    <footer class="bg-slate-900 text-gray-400 py-8 mt-auto border-t border-slate-800">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <span class="text-xl font-bold text-white flex items-center gap-2">
                        <i class="fa-solid fa-graduation-cap text-indigo-500"></i> EduTech
                    </span>
                    <p class="text-sm mt-1">Geleceğini kodlamaya başla.</p>
                </div>
                <div class="text-sm">
                    &copy; 2024 EduTech. İleri Web Programlama Projesi.
                </div>
            </div>
        </div>
    </footer>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        // Controller'dan gelen başarı mesajını yakala
        var successMessage = '@TempData["SuccessMessage"]';
        var errorMessage = '@TempData["Error"]'; // Hata mesajı varsa onu da yakalayalım

        // Toast Ayarları
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer)
                toast.addEventListener('mouseleave', Swal.resumeTimer)
            }
        });

        // Başarılı Mesajı Varsa
        if (successMessage) {
            Toast.fire({
                icon: 'success',
                title: successMessage
            });
        }

        // Hata Mesajı Varsa (Kırmızı)
        if (errorMessage) {
            Toast.fire({
                icon: 'error',
                title: errorMessage
            });
        }
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>